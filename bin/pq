#!/usr/bin/env python2
"""
Print the pickle file from stdin to stdout.
"""

import os
import sys
from cPickle import load
from pprint import pprint

def main():
    try:
        _, filter, fname = sys.argv
    except ValueError:
        print("Usage: %s filter file" % sys.argv[0])
        sys.exit(1)

    _, columns = os.popen('stty size', 'r').read().split()
    columns = int(columns)

    x = load(open(fname, "rb"))
    z = eval(filter, {"x": x})

    try:
        pprint(z, indent=2, width=columns)
    except IOError:
        pass

if __name__ == '__main__':
    main()
