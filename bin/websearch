#!/usr/bin/env python2
# encoding: utf-8
"""
Run web search query from terminal.
"""

from __future__ import division, print_function

__author__ = "Parantapa Bhattachara <pb [at] parantapa [dot] net>"

import sys
from subprocess import call
from urllib import quote_plus

SEARCH_BASE = {
    "g": "https://www.google.com/search?q={0}",
    "d": "http://dictionary.reference.com/browse/{0}",
    "t": "http://www.thesaurus.com/browse/{0}",
    "ud": "http://www.urbandictionary.com/define.php?term={0}",
    "wa": "http://www.wolframalpha.com/input/?i={0}",
    "gs": "https://scholar.google.com/scholar?q={0}"
}

BROWSER_CMD = "firefox '{0}' >/dev/null 2>&1 &"

def main():
    print(sys.argv)

    if len(sys.argv) < 2:
        print("Usage: websearch TERMS ENGINE")
        sys.exit(1)


    if len(sys.argv) == 2:
        argv = sys.argv[1].split()
    else:
        argv = sys.argv[1:]

    engine = argv[-1]
    if engine not in SEARCH_BASE:
        print("Unknown search engine: '{0}'".format(engine))
        sys.exit(1)

    terms = argv[:-1]
    terms = " ".join(terms)
    terms = quote_plus(terms)

    url = SEARCH_BASE[engine].format(terms)
    cmd = BROWSER_CMD.format(url)

    call(cmd, shell=True)

if __name__ == '__main__':
    main()
